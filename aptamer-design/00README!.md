# 该项目仍在开发ing
## 项目的目的：
通过程序对aptamer进行建模，输出pdb、mol格式文件方便后续批量化分子对接和虚拟筛选

## 项目思路：
**1.** 首先基于SMILES格式要求，对指定Aptamer序列进行建模，批量化得出指定Aptamer序列的SMILES格式文件；  
**2.** 将SMILES格式文件转化为标准SMILES格式文件，并进行pdb、mol格式批量化、自动化生成；  
**3.** 同时输出svg、png等过程图片验证构象，辅助判断。  

## 实际过程
**1.** 单体的SMILES格式转化  
对于标准SMILES格式文件，通常只有一种描述，但是实际上由诸多描述，例如对于同一dNTP，以下的smiles格式都可以可视化为相同的dNTP分子：
特征部分：  
  A: n2cnc3c2ncnc3N  
  T: N2C=C(2)C(=O)NC2=O  
  C: n2ccc(nc2=O)N  
  G: n2cnc3c2nc(N)[nH]c(=O)3  

平面格式A:  
    A:  OP(=O)(O)OCC1OC(n2cnc3c2ncnc3N)CC1O  
    T:  OP(=O)(O)OCC1OC(N2C=C(C)C(=O)NC2=O)CC1O  
    C:  OP(=O)(O)OCC1OC(n2ccc(nc2=O)N)CC1O  
    G:  OP(=O)(O)OCC1OC(n2cnc3c2nc(N)[nH]c(=O)3)CC1O  

立体格式A:  
    A:  OP(=O)(O)OC[C@@]1O[C@@](n2cnc3c2ncnc3N)C[C@@]1O  
    T:  OP(=O)(O)OC[C@@]1O[C@@](N2C=C(C)C(=O)NC2=O)C[C@@]1O  
    C:  OP(=O)(O)OC[C@@]1O[C@@](n2ccc(nc2=O)N)C[C@@]1O  
    G:  OP(=O)(O)OC[C@@]1O[C@@](n2cnc3c2nc(N)[nH]c(=O)3)C[C@@]1O  

立体格式B:  
    A:  O=[P]([O-])(OC([H])([H])[C@@]3([H])O[C@@]([H])(N2C([H])=NC=1C(=NC([H])=NC=12)N([H])[H])C([H])([H])[C@@]3([O-])[H])O[H]  
    T:  O=[P]([O-])(OC([H])([H])[C@@]2([H])O[C@@]([H])(N1C(=O)N([H])C(=O)C(=C1[H])C([H])([H])[H])C([H])([H])[C@@]2([O-])[H])O[H]  
    C:  O=[P]([O-])(OC([H])([H])[C@@]2([H])O[C@@]([H])(N1C(=O)N=C(N([H])[H])C([H])=C1[H])C([H])([H])[C@@]2([O-])[H])O[H]  
    G:  O=[P]([O-])(OC([H])([H])[C@@]3([H])O[C@@]([H])(N1C([H])=NC=2C(=O)N([H])C(=NC1=2)N([H])[H])C([H])([H])[C@@]3([O-])[H])O[H]  

特殊G:  
    G:  Nc1nc2c(ncn2C2CC(O)C(COP(=O)(O)O)O2)c(=O)[nH]1  

立体格式C  
    A:  O=[P]([O-])(OC[C@@]3O[C@@](N2C=NC=1C(=NC=NC=12)N)C[C@@]3([O-]))O  
    T:  O=[P]([O-])(OC[C@@]2O[C@@](N1C(=O)NC(=O)C(=C1)C)C[C@@]2([O-]))O  
    C:  O=[P]([O-])(OC[C@@]2O[C@@](N1C(=O)N=C)C([H])=C1)C[C@@]2([O-]))O  
    G:  O=[P]([O-])(OC[C@@]3O[C@@](N1C=NC=2C(=O)NC(=NC1=2)N)C[C@@]3([O-]))O  

关于选择哪一种作为后续的格式依赖很重要，也很关键，因为不仅仅牵扯到字符运算的大小、处理速度，还牵扯到结构过程实现函数设计、函数成功与否等很多因素。。。   

**2.**  实现思路
采用的RDkit进行实现；  
大体思路为：  
对单体进行处理；  
设计函数考虑环数字标记；
循环添加dNTP;
RDKIT有效性检查；
加氢；
输出格式；

**3.** 文件说明  
01文件为分割长aptamer序列为短aptamer序列的尝试；
03MAIN和04完整都是可以运行的程序；
smiles2pdb为格式转化程序；
t为测试程序；
其余图片为验证图片

## 这里必须要着重指出一些地方：    
**A** 对于SMILES格式必须要有一个清晰明确的认知，否则很容易就被误导进而没有办法实现想要的分子结构的设计；  
**B** 仅仅有dNTP的单元的SMILES格式远远不够，再处理过程中，无论是当成简单的字符连接，还是使用反应模块进行处理，都必须要考虑到作为一个分子整体所具有的连续性，以及这种连续对SMILES字符的影响，典例即是SMILES格式中的环的数字标签，这需要着重考虑，否则程序会频繁报错；  
**C** dNTP之间的连接时一个化学反应，反映到字符的处理上，就是对单体进行部分原子的舍去和处理，这一部分也很需要精心设计，并且无论是再rdkit、还是openbabel中进行格式的生成和转换时，一旦分子数量过大，会导致出现原子价态过高、未成环等一系列报错；
**D** 特别注意，可以查到的dNTP的SMILES结构中，按照不同的表述总是会出现表述格式不统一的情况，这一点可以参考上面的一些SMILES格式，已经完全实现了A\T\C\G的统一形式输出；   
**E** 还是特别要说明，该程序能够实现完全的SMILES格式生成以及标准SMILES格式转化；小分子量的pdb、mol格式生成，以及对应的图片验证；但是无法实现大分子的生成！根因是没有一个统一环境下的化学信息、生物信息分子软件从而支持处理七八千乃至上万的分子量的分子的生成。该程序在处理十数个、七八个碱基时，速度很快；但是一旦到30、40乃至70、80，程序后期直接报错。目前尚未明确原因；留待后期探究。   
**F** 通过这一个项目对于aptamer虚拟筛选的认知更加明确了，大分子量的蛋白和核酸之间的相互对接是一件及其困难的事情；首先大分子的aptamer的坐标文件就极难批量化、自动化处理和生成；其次目前也只有ZDOCK、HEX等平台能够实现，其余的类似Autodock、vina等分子对接程序都无法实现对于大分子量的对接需求；再者则是由于各种各样的化学格式之间转化经常会导致格式错误，使得进程错误！  

## 小结  
**1.** 初步实践简单aptamer格式批量化生成和实现；  
**2.** 倘若没有批量化要求下，全部的从格式生成、预处理、简单模拟、预测都可独立完成，这也算是收获颇丰。
**3.** 对RDkit、openbabel、biopython等软件有了深入认识，代码设计和实践水平得到了锻炼。
**4.** 对常见的主流量化软件、模拟软件、对接软件、可视化软件如：VMD、pymol、DSV、MS、vina、ledock等使用愈发熟练，理解更加深入。
**5.** 确定了从生成式进行结构设计的思路，待日后进行进一步学习和设计。


